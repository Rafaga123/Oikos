<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear</title>
    
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <!-- Semantic UI -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
    
    <!-- CSS Personalizado -->
    <style>
        body {
            background-image: url(/Images/Fondopagina.png);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            min-height: 100vh;
        }
        
        .sidebar-menu .item {
    /*Aumenta la fuente de todo el texto del item*/
    font-size: 1.15em; 

    /*Añade más espacio vertical entre los items para que se vean mejor*/
    padding-top: 18px !important;
    padding-bottom: 18px !important;
}

/* Aumentar el tamaño de los iconos dentro de los elementos del menú */
.sidebar-menu .item i.icon {
    /*Aumenta el tamaño de la fuente del icono*/
    font-size: 1.5em !important;

    /*Asegura que haya más espacio entre el icono y el texto*/
    margin-right: 15px !important; 
}

.sidebar-footer-image {
    flex-grow: 1; /*Ocupa el espacio restante del sidebar */
    display: flex;
    justify-content: center;
    align-items: flex-end; /* Alinea la imagen a la parte inferior del espacio */
    padding: 20px; /* Espacio de relleno para que no se pegue al borde */
}

/*Estilos de la Imagen*/
.sidebar-footer-image img {
    /* Asegura que la imagen no exceda el ancho del sidebar */
    max-width: 100%; 
    /* Define una altura máxima para que no empuje el menú */
    max-height: 150px; 
    /* Mantiene la proporción de la imagen */
    height: auto; 

}

.sidebar-menu.visible {
    transform: translateX(0);
}
        .main-content {
            padding: 100px 30px 50px;
            min-height: 100vh;
        }
        
        .creation-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            padding: 30px;
        }
        
        .type-selector {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .type-card {
            flex: 1;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
        }
        
        .type-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .type-card.selected {
            border-color: #2185d0;
            background: #f0f7ff;
        }
        
        .type-card i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .type-card.announcement i {
            color: #21ba45; /* Verde para anuncios */
        }
        
        .type-card.survey i {
            color: #f2711c; /* Naranja para encuestas */
        }
        
        .creation-form {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .creation-form.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .option-item input {
            flex: 1;
        }
        
        .preview-section {
            margin-top: 40px;
            border-top: 1px solid #e0e0e0;
            padding-top: 30px;
        }
        
        .preview-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            min-height: 200px;
        }
        
        .announcement-preview {
            border-left: 4px solid #21ba45;
        }
        
        .survey-preview {
            border-left: 4px solid #f2711c;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .type-selector {
                flex-direction: column;
            }
            
            .main-content {
                padding: 100px 20px 30px;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="ui vertical inverted sidebar menu sidebar-menu" style="background-color: #9A9CEA;">
        <div class="item">
            <div class="header">
                <h2 class="ui inverted header">
                    <i class="cog icon"></i>
                    <div class="content">
                        Panel Gestor
                        <div class="sub header">Gestión de Habitantes</div>
                    </div>
                </h2>
            </div>
        </div>
        <div class="item">
            <div class="menu">
                <a class="active item">
                    <i class="home icon"></i>
                    Panel de Control
                </a>
                <a class="item" href="gestion_habitantes.html">
                    <i class="users icon"></i>
                    Habitantes
                </a>
                <a class="item">
                    <i class="chart bar icon"></i>
                    Solicitudes
                </a>
                <a class="item">
                    <i class="cogs icon"></i>
                    Configuración
                </a>
            </div>
        </div>
        <div class="item">
            <div class="ui divider"></div>
            <a class="item">
                <i class="sign out icon"></i>
                Cerrar Sesión
            </a>
        </div>
        <div class="sidebar-footer-image">
            <img src="../Images/logopng.png" alt="Decoración de Sidebar">
        </div>
    </div>

    <!--contenido de la pagina del gestor-->
    <div class="pusher">
        <!--Menú Superior-->
        <div class="ui top fixed stackable menu" style="background-color: #9A9CEA;">
            <div class="ui container">
                <div class="item">
                    <img src="../Images/logopng.png" alt="Logo"> <!--logo de la pagina-->
                </div>
                <a class="item" id="sidebar-toggle"><!--activador del sidebar-->
                    <i class="sidebar icon" style="color: white;"></i><!--Icono del sidebar-->
                </a>
                <div class="header item" style="color: white;"><!--color y titulo del menu superior-->
                    Crear encuestas o Anuncios
                </div>
                <div class="right menu">
                    <div class="ui dropdown item" style="color: white;">
                        <i class="user icon" style="color: white;"></i> Gestor
                        <i class="dropdown icon"></i>
                        <div class="menu">
                            <a class="item"><i class="user icon"></i> Mi Perfil</a>
                            <a class="item"><i class="cog icon"></i> Configuración</a>
                            <div class="divider"></div>
                            <a class="item"><i class="sign out icon"></i> Cerrar Sesión</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="ui container">
                <!-- Header -->
                <div class="ui header">
                    <h1>
                        <i class="plus circle icon"></i>
                        Crear Nuevo Contenido
                        <div class="sub header">Crea anuncios o encuestas para la comunidad</div>
                    </h1>
                </div>
                
                <div class="ui divider"></div>
                
                <!-- Contenedor Principal -->
                <div class="creation-container">
                    <!-- Selector de Tipo -->
                    <div class="type-selector">
                        <div class="type-card announcement" data-type="announcement">
                            <i class="bullhorn icon"></i>
                            <h3 class="ui header">Anuncio</h3>
                            <p>Comunica información importante a todos los habitantes</p>
                            <div class="ui green label">Recomendado para noticias urgentes</div>
                        </div>
                        
                        <div class="type-card survey" data-type="survey">
                            <i class="chart pie icon"></i>
                            <h3 class="ui header">Encuesta</h3>
                            <p>Consulta la opinión de la comunidad sobre un tema</p>
                            <div class="ui orange label">Perfecto para decisiones grupales</div>
                        </div>
                    </div>
                    
                    <!-- Formulario de Anuncio -->
                    <div class="creation-form" id="announcement-form">
                        <h2 class="ui dividing header">
                            <i class="bullhorn icon"></i>
                            Nuevo Anuncio
                        </h2>
                        
                        <form class="ui form" id="announcementForm">
                            <div class="field">
                                <label>Título del Anuncio *</label>
                                <input type="text" id="announcement-title" placeholder="Ej: Mantenimiento programado del ascensor" required>
                            </div>
                            
                            <div class="field">
                                <label>Categoría *</label>
                                <select class="ui dropdown" id="announcement-category" required>
                                    <option value="">Seleccionar categoría</option>
                                    <option value="mantenimiento">Mantenimiento</option>
                                    <option value="seguridad">Seguridad</option>
                                    <option value="evento">Evento Comunitario</option>
                                    <option value="importante">Aviso Importante</option>
                                    <option value="otro">Otro</option>
                                </select>
                            </div>
                            
                            <div class="field">
                                <label>Contenido del Anuncio *</label>
                                <textarea id="announcement-content" rows="6" placeholder="Describe el anuncio en detalle..." required></textarea>
                            </div>
                            
                            <div class="two fields">
                                <div class="field">
                                    <label>Fecha de Publicación</label>
                                    <input type="date" id="announcement-date" value="<?php echo date('Y-m-d'); ?>">
                                </div>
                                <div class="field">
                                    <label>Fecha de Expiración</label>
                                    <input type="date" id="announcement-expiry">
                                </div>
                            </div>
                            
                            <div class="field">
                                <div class="ui toggle checkbox">
                                    <input type="checkbox" id="announcement-priority">
                                    <label>Marcar como prioridad alta</label>
                                </div>
                            </div>
                            
                            <div class="ui divider"></div>
                            
                            <button type="submit" class="ui green button">
                                <i class="paper plane icon"></i>
                                Publicar Anuncio
                            </button>
                            <button type="button" class="ui button" id="preview-announcement">
                                <i class="eye icon"></i>
                                Vista Previa
                            </button>
                        </form>
                    </div>
                    
                    <!-- Formulario de Encuesta -->
                    <div class="creation-form" id="survey-form">
                        <h2 class="ui dividing header">
                            <i class="chart pie icon"></i>
                            Nueva Encuesta
                        </h2>
                        
                        <form class="ui form" id="surveyForm">
                            <div class="field">
                                <label>Título de la Encuesta *</label>
                                <input type="text" id="survey-title" placeholder="Ej: Opinión sobre el nuevo horario de piscina" required>
                            </div>
                            
                            <div class="field">
                                <label>Descripción *</label>
                                <textarea id="survey-description" rows="3" placeholder="Explica el propósito de esta encuesta..." required></textarea>
                            </div>
                            
                            <!-- Opciones de la Encuesta -->
                            <div class="field">
                                <label>Opciones de Respuesta *</label>
                                <div id="survey-options">
                                    <div class="option-item">
                                        <input type="text" placeholder="Opción 1" class="survey-option" required>
                                        <button type="button" class="ui icon button remove-option" disabled>
                                            <i class="minus icon"></i>
                                        </button>
                                    </div>
                                    <div class="option-item">
                                        <input type="text" placeholder="Opción 2" class="survey-option" required>
                                        <button type="button" class="ui icon button remove-option" disabled>
                                            <i class="minus icon"></i>
                                        </button>
                                    </div>
                                </div>
                                <button type="button" class="ui basic button" id="add-option">
                                    <i class="plus icon"></i>
                                    Agregar Opción
                                </button>
                            </div>
                            
                            <div class="two fields">
                                <div class="field">
                                    <label>Fecha de Inicio</label>
                                    <input type="date" id="survey-start-date" value="<?php echo date('Y-m-d'); ?>">
                                </div>
                                <div class="field">
                                    <label>Fecha de Cierre</label>
                                    <input type="date" id="survey-end-date">
                                </div>
                            </div>
                            
                            <div class="field">
                                <label>Tipo de Votación</label>
                                <div class="ui radio checkbox">
                                    <input type="radio" name="vote-type" value="single" checked>
                                    <label>Voto Único (una opción)</label>
                                </div>
                                <div class="ui radio checkbox">
                                    <input type="radio" name="vote-type" value="multiple">
                                    <label>Voto Múltiple (varias opciones)</label>
                                </div>
                            </div>
                            
                            <div class="ui divider"></div>
                            
                            <button type="submit" class="ui orange button">
                                <i class="chart pie icon"></i>
                                Crear Encuesta
                            </button>
                            <button type="button" class="ui button" id="preview-survey">
                                <i class="eye icon"></i>
                                Vista Previa
                            </button>
                        </form>
                    </div>
                    
                    <!-- Vista Previa -->
                    <div class="preview-section">
                        <h3 class="ui header">
                            <i class="eye icon"></i>
                            Vista Previa
                        </h3>
                        <div class="preview-box" id="preview-content">
                            <p class="ui center aligned text" style="color: #999;">
                                Selecciona un tipo y completa el formulario para ver la vista previa
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        $(document).ready(function() {
            // Inicializar componentes
            $('.ui.dropdown').dropdown();
            $('.ui.checkbox').checkbox();
            
            // Sidebar toggle (usando tu lógica existente)
            $('#sidebar-toggle').click(function() {
                $('.ui.sidebar').sidebar('toggle');
            });
            
            // Para pantallas grandes, mostrar sidebar como fijo
            if ($(window).width() > 768) {
                $('.ui.sidebar').addClass('visible');
                $('.ui.sidebar').sidebar({
                    context: $('.pusher'),
                    transition: 'overlay'
                });
            }

            // Selector de tipo
            let selectedType = null;
            
            $('.type-card').click(function() {
                $('.type-card').removeClass('selected');
                $(this).addClass('selected');
                
                selectedType = $(this).data('type');
                
                // Mostrar formulario correspondiente
                $('.creation-form').removeClass('active');
                $(`#${selectedType}-form`).addClass('active');
                
                // Actualizar vista previa
                updatePreview();
            });
            
            // Manejo de opciones en encuestas
            let optionCount = 2;
            
            $('#add-option').click(function() {
                optionCount++;
                const newOption = `
                    <div class="option-item">
                        <input type="text" placeholder="Opción ${optionCount}" class="survey-option" required>
                        <button type="button" class="ui icon button remove-option">
                            <i class="minus icon"></i>
                        </button>
                    </div>
                `;
                $('#survey-options').append(newOption);
                
                // Habilitar botones de eliminar
                if (optionCount > 2) {
                    $('.remove-option').prop('disabled', false);
                }
            });
            
            // Eliminar opción
            $(document).on('click', '.remove-option', function() {
                if (optionCount > 2) {
                    $(this).closest('.option-item').remove();
                    optionCount--;
                    
                    // Renumerar opciones
                    $('.survey-option').each(function(index) {
                        $(this).attr('placeholder', `Opción ${index + 1}`);
                    });
                    
                    if (optionCount <= 2) {
                        $('.remove-option').prop('disabled', true);
                    }
                }
            });
            
            // Actualizar vista previa en tiempo real
            function updatePreview() {
                const preview = $('#preview-content');
                
                if (!selectedType) {
                    preview.html('<p class="ui center aligned text" style="color: #999;">Selecciona un tipo y completa el formulario para ver la vista previa</p>');
                    return;
                }
                
                if (selectedType === 'announcement') {
                    const title = $('#announcement-title').val() || '[Título del anuncio]';
                    const category = $('#announcement-category').val() || 'general';
                    const content = $('#announcement-content').val() || '[Contenido del anuncio]';
                    const priority = $('#announcement-priority').is(':checked');
                    
                    preview.html(`
                        <div class="announcement-preview">
                            <div class="ui ${priority ? 'red' : 'green'} ribbon label">${getCategoryName(category)}</div>
                            <h3 class="ui header">${title}</h3>
                            <div class="ui divider"></div>
                            <p>${content.replace(/\n/g, '<br>')}</p>
                            <div class="ui small text" style="color: #666; margin-top: 20px;">
                                <i class="calendar icon"></i> Publicado: ${new Date().toLocaleDateString('es-ES')}
                                ${priority ? '<span class="ui red horizontal label"><i class="exclamation circle icon"></i> ALTA PRIORIDAD</span>' : ''}
                            </div>
                        </div>
                    `);
                } else {
                    const title = $('#survey-title').val() || '[Título de la encuesta]';
                    const description = $('#survey-description').val() || '[Descripción de la encuesta]';
                    const options = [];
                    
                    $('.survey-option').each(function() {
                        const val = $(this).val();
                        if (val) options.push(val);
                    });
                    
                    preview.html(`
                        <div class="survey-preview">
                            <h3 class="ui header">${title}</h3>
                            <p>${description}</p>
                            <div class="ui form">
                                <div class="grouped fields">
                                    <label>Selecciona tu respuesta:</label>
                                    ${options.map((opt, i) => `
                                        <div class="field">
                                            <div class="ui radio checkbox">
                                                <input type="radio" name="preview-survey">
                                                <label>${opt || `Opción ${i+1}`}</label>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="ui small text" style="color: #666; margin-top: 20px;">
                                <i class="chart pie icon"></i> Encuesta • 
                                <i class="users icon"></i> Para todos los habitantes
                            </div>
                        </div>
                    `);
                }
            }
            
            // Escuchar cambios en los formularios
            $('#announcementForm input, #announcementForm textarea, #announcementForm select').on('input change', updatePreview);
            $('#surveyForm input, #surveyForm textarea').on('input change', updatePreview);
            
            // Botones de vista previa
            $('#preview-announcement').click(updatePreview);
            $('#preview-survey').click(updatePreview);
            
            // Enviar formularios
            $('#announcementForm').submit(function(e) {
                e.preventDefault();
                // Aquí iría la lógica para guardar el anuncio
                alert('Anuncio creado exitosamente!');
            });
            
            $('#surveyForm').submit(function(e) {
                e.preventDefault();
                // Aquí iría la lógica para guardar la encuesta
                alert('Encuesta creada exitosamente!');
            });
            
            // Helper para nombres de categoría
            function getCategoryName(category) {
                const categories = {
                    'mantenimiento': 'Mantenimiento',
                    'seguridad': 'Seguridad',
                    'evento': 'Evento',
                    'importante': 'Importante',
                    'otro': 'Otro'
                };
                return categories[category] || 'General';
            }
        });
    </script>
</body>
</html>